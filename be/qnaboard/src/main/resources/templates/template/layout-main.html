<!--/*
모든 페이지의 기본 레이아웃이 되는 템플릿.
새로 페이지를 만든다면 이 템플릿을 사용하면 된다.
페이지의 제목과 컨텐츠는 이 템플릿의 파라미터로 넘기면 된다

사용자의 로그인 여부에 따라 네비바의 내용이 바뀐다.
만약 로그인된 사용자라면 세번째 파라미터인 username 으로 사용자의 이름을 넘겨주면 된다
비로그인 사용자라면 null을 넘기면 된다

자바스크립트는 body태그의 아래에 추가하면 된다.
*/-->

<!DOCTYPE html>
<html lang="kr" th:fragment="layout (title, content, username, scripts)"
      xmlns:th="http://www.thymeleaf.org">

<head th:replace="template/fragment/base-head :: base_head(${title})">
</head>

<body>
<div th:replace="template/fragment/navibar :: navibar(${username})"></div>
<div class="container-fluid">
    <div class="row">
        <div th:replace="template/fragment/sidebar/sidebar :: sidebar"></div>
        <div class="col-md-9 col-lg-10 content" style="min-height: 80vh;">
            <div th:replace="${content}"></div>
        </div>
    </div>
</div>
<div th:replace="template/fragment/footer/footer :: footer"></div>

</body>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/js/lib/apiHelper.js}"></script>
<script th:src="@{/js/lib/answer.js}"></script>
<script th:src="@{/js/lib/comment.js}"></script>
<script>

    /**
     * 부트스트랩 버튼의 애니메이션을 고치기 위한 함수. 포커스를 대상 엘리먼트에 부여하고, 150초 후에 풀어버린다.
     *
     * @param element 대상 엘리먼트
     */
    const handleBtnClickEffect = (element) => {
        element.focus();
        setTimeout(() => {
            element.blur();
        }, 150);
    };
    const elements = document.querySelectorAll(".btn");
    for (const element of elements) {
        element.addEventListener("pointerdown", () => handleBtnClickEffect(element));
    }
</script>
<script>
    //사이드바 active 처리
    const sidebarLinks = document.querySelectorAll(".sidebar-link");
    const pathname = document.location.pathname;

    let isSelected = false;
    //링크의 주소와 페이지의 현재주소가 같으면 active클래스를 부여함
    for (const sidebarLink of sidebarLinks) {
        const elementPathname = sidebarLink.pathname;
        if (pathname === elementPathname) {
            sidebarLink.classList.add("active");
            isSelected = true;
            break;
        }
    }
    //경로가 루트면 첫번째 아이템에 active를 부여함
    if (pathname === "/") {
        sidebarLinks[0].classList.add("active");
    }

</script>
<script th:replace="${scripts}?:_"></script>
</html>
